* crash
*** ½ø³ÌcrashÊ±»á·¢ËÍsignal£¨SIGSEGV£¬SIGART etc£©£¬ÌáÇ°×¢²ásigaction´¦ÀíÄ¿±êsignal£¬È»ºóclone½ø³Ì£¬Ê¹ÓÃptrace syscall»ñ È¡½ø³Ìmem regĞÅÏ¢£¬Í¬Ê±»ñÈ¡procfsĞÅÏ¢µÃµ½thread stacktrace
*** breakpad   ---> crashDump --> addr2line
*** forkºÍpthread_create¶¼Ê¹ÓÃclone syscallÊµÏÖ£¬¿ÉÒÔÖ¸¶¨¹²ÏíÄÄĞ©Êı¾İÇøÓò
*** core dump file
**** with systemd systems cat /proc/sys/kernel/core_pattern -> |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h %e
**** core dump files stored in directory /var/lib/systemd/coredump
**** core dump file managed by coredumpctl
**** list all core dump files: coredumpctl list | tail -5
**** extract core dump file: coredumpctl dump ${pid} -o core
* Finalizer
*** object.finalize() run in FinalizerDaemon thread
*** FinalizerWatchdogDaemon thread ¼à¿ØFinalizerDaemon threadµÄÖ´ĞĞ£¬ÈôFinalizerDaemonÖ´ĞĞÄ³¸öobjectµÄfinalize·½·¨³¬¹ı10s£¬
Ôò·¢³öSIGQUIT signal
*** finalize timeout ¿ÉÒÔÍ¨¹ı·´ÉäÍ£Ö¹FinalizerWatchdogDaemon£¬Android PÏŞÖÆ·´Éäµ÷ÓÃÊ§Ğ§
=======
*** è¿›ç¨‹crashæ—¶ä¼šå‘é€signalï¼ˆSIGSEGVï¼ŒSIGART etcï¼‰ï¼Œæå‰æ³¨å†Œsigactionå¤„ç†ç›®æ ‡signalï¼Œç„¶åcloneè¿›ç¨‹ï¼Œä½¿ç”¨ptrace syscallè·
å–è¿›ç¨‹mem regä¿¡æ¯ï¼ŒåŒæ—¶è·å–procfsä¿¡æ¯å¾—åˆ°thread stacktrace
*** breakpad   ---> crashDump --> addr2line
*** forkå’Œpthread_createéƒ½ä½¿ç”¨clone syscallå®ç°ï¼Œå¯ä»¥æŒ‡å®šå…±äº«å“ªäº›æ•°æ®åŒºåŸŸ

* Finalizer
*** object.finalize() run in FinalizerDaemon thread
*** FinalizerWatchdogDaemon thread ç›‘æ§FinalizerDaemon threadçš„æ‰§è¡Œï¼Œè‹¥FinalizerDaemonæ‰§è¡ŒæŸä¸ªobjectçš„finalizeæ–¹æ³•è¶…è¿‡10sï¼Œ
åˆ™å‘å‡ºSIGQUIT signal
*** finalize timeout å¯ä»¥é€šè¿‡åå°„åœæ­¢FinalizerWatchdogDaemonï¼ŒAndroid Pé™åˆ¶åå°„è°ƒç”¨å¤±æ•ˆ

>>>>>>> e80601e80df28628831ae79051adec54334840ee
* generate code at runtime
*** u1 code[PAGE_SIZE]; mprotect(code, PAGE_SIZE, PROT_READ | PROT_WRITE | PROT_EXEC); memcpy(code, "\xC3", 1);
* RecyclerView
*** Recycler.tryGetViewHolderForPositionByDeadlineç¼“å­˜é€»è¾‘: 
# æ ¹æ®positionæŸ¥æ‰¾mAttachedScrap-->mHiddenViews-->mCachedViewsï¼Œ
# æ ¹æ®typeæŸ¥æ‰¾mAttachedScrap-->mCachedViews
# if mViewCacheExtension != null, é€šè¿‡mViewCacheExtensionæŸ¥æ‰¾
# mRecyclerPoolä¸­æŸ¥æ‰¾
# mAdapter.createViewHolder

* android gradle plugin
*** æ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯é—­åŒ…æ—¶å¯ä»¥å°†{}ç§»åˆ°()å¤–ï¼ŒåŒæ—¶()å¯ä»¥çœç•¥ï¼Œæ‰€ä»¥å¸¸è§çš„android {...}
*** androidåŒ…å«å±æ€§ï¼šcompileSdkVersionã€buildToolsVersionã€defaultConfigã€buildTypesã€signingConfigsã€lintOptionsã€
compileOptions etc
*** defaultConfigæ˜¯é»˜è®¤çš„productFlavorç±»å‹ï¼ŒåŒ…å«applicationIdã€minSdkVersionã€versionCodeã€versionNameã€
testInstrumentationRunnerã€ndk etc
*** buildTypeå±æ€§ï¼šapplicationSuffixã€debuggableã€jniDebuggableã€minifyEnabledã€multiDexEnabledã€proguardFileã€shrinkResourcesã€
signingConfigã€zipAlignEnabled
*** variant æ˜¯productFlavorså’ŒbuildTypesç»„åˆäº§ç‰©ï¼Œvariantæœ‰applicationVariantsã€libraryVariantsã€testVariants
*** ä½¿ç”¨execå¯ä»¥æ‰§è¡Œå‘½ä»¤è¡Œæ“ä½œ
*** å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡System.getenv()è·å–ç­¾åä¿¡æ¯ï¼Œä»è€Œéšè—ç­¾åä¿¡æ¯
*** manifestPlaceHolders buildConfigField resValue
* Java Thread start
*** android-source/art/runtime/thread_state.h
enum ThreadState {
  //                                   Thread.State   JDWP state
  kTerminated = 66,                 // TERMINATED     TS_ZOMBIE    Thread.run has returned, but Thread* still around
  kRunnable,                        // RUNNABLE       TS_RUNNING   runnable
  kTimedWaiting,                    // TIMED_WAITING  TS_WAIT      in Object.wait() with a timeout
  kSleeping,                        // TIMED_WAITING  TS_SLEEPING  in Thread.sleep()
  kBlocked,                         // BLOCKED        TS_MONITOR   blocked on a monitor
  kWaiting,                         // WAITING        TS_WAIT      in Object.wait()
  kWaitingForLockInflation,         // WAITING        TS_WAIT      blocked inflating a thin-lock
  kWaitingForTaskProcessor,         // WAITING        TS_WAIT      blocked waiting for taskProcessor
  kWaitingForGcToComplete,          // WAITING        TS_WAIT      blocked waiting for GC
  kWaitingForCheckPointsToRun,      // WAITING        TS_WAIT      GC waiting for checkpoints to run
  kWaitingPerformingGc,             // WAITING        TS_WAIT      performing GC
  kWaitingForDebuggerSend,          // WAITING        TS_WAIT      blocked waiting for events to be sent
  kWaitingForDebuggerToAttach,      // WAITING        TS_WAIT      blocked waiting for debugger to attach
  kWaitingInMainDebuggerLoop,       // WAITING        TS_WAIT      blocking/reading/processing debugger events
  kWaitingForDebuggerSuspension,    // WAITING        TS_WAIT      waiting for debugger suspend all
  kWaitingForJniOnLoad,             // WAITING        TS_WAIT      waiting for execution of dlopen and JNI on load code
  kWaitingForSignalCatcherOutput,   // WAITING        TS_WAIT      waiting for signal catcher IO to complete
  kWaitingInMainSignalCatcherLoop,  // WAITING        TS_WAIT      blocking/reading/processing signals
  kWaitingForDeoptimization,        // WAITING        TS_WAIT      waiting for deoptimization suspend all
  kWaitingForMethodTracingStart,    // WAITING        TS_WAIT      waiting for method tracing to start
  kWaitingForVisitObjects,          // WAITING        TS_WAIT      waiting for visiting objects
  kWaitingForGetObjectsAllocated,   // WAITING        TS_WAIT      waiting for getting the number of allocated objects
  kWaitingWeakGcRootRead,           // WAITING        TS_WAIT      waiting on the GC to read a weak root
  kWaitingForGcThreadFlip,          // WAITING        TS_WAIT      waiting on the GC thread flip (CC collector) to finish
  kStarting,                        // NEW            TS_WAIT      native thread started, not yet ready to run managed code
  kNative,                          // RUNNABLE       TS_RUNNING   running in a JNI native method
  kSuspended,                       // RUNNABLE       TS_RUNNING   suspended by GC or debugger
};
*** android-source/art/runtime/native/java_lang_Thread.cc
Thread.start()-->nativeCreate()-->Thread.CreateNativeThread()-->JNIEnvExt::Creat()-->pthread_create()-->child_thread invoke java Thread.run() method
*** JNIEnv implemented in android-source/art/runtime/jni_internal.cc
* x86_64
*** å‡½æ•°ä¼ å‚å¯„å­˜å™¨é¡ºåºrdi, rsi, rdx, rcx, r8, r9ï¼Œè¶…è¿‡6ä¸ªåˆ™å‹æ ˆ
*** callqä¼špush %rip(return address aka.ä¸‹ä¸€æ¡æŒ‡ä»¤)
*** %raxä¿å­˜è¿”å›å€¼
* gdb
*** $sp $pc $fp åˆ«åé€‚ç”¨æ‰€æœ‰å¹³å°
*** x/i $pc å½“å‰æŒ‡ä»¤
*** x/32x $sp æ˜¾ç¤ºstackå†…å­˜ä¿¡æ¯
*** objdump -dS elfæ˜¾ç¤ºæ±‡ç¼–
*** disas/m åæ±‡ç¼–code
* lag analyze tool
*** TraceView
  - Debug.startMethodTracing("sample") Debug.startMethodTracingSampling() Debug.stopMethodTracing()
*** Systrace
  - ./systrace.py sched freq idle am wm gfx view sync binder_driver irq workq input -b 96000
  - java framework: Trace.traceBegin(long traceTag, String methodName) Trace.traceEnd(long traceTag)
  - app: Trace.beginSection(String sectionName) Trace.endSection()
  - native: ATRACE_CALL();
*** è·å–GCç»Ÿè®¡ä¿¡æ¯
  - // GC ä½¿ç”¨çš„æ€»è€—æ—¶ï¼Œå•ä½æ˜¯æ¯«ç§’
    Debug.getRuntimeStat("art.gc.gc-time");
    // é˜»å¡å¼ GC çš„æ€»è€—æ—¶
    Debug.getRuntimeStat("art.gc.blocking-gc-time");

* C++ mangle/demangle tool
*** c++filt -n _ZN7android6Tracer12sEnabledTagsE
* Hook
** inline hook 
*** Substrate
**** MSHookFunction(void *symbol, void *replace, void **result)
 - ä½œç”¨ï¼šsymbolï¼šåŸå‡½æ•°åœ°å€ï¼Œreplaceï¼šhookå‡½æ•°åœ°å€ï¼Œresultï¼šè¿”å›åŠ¨æ€ç”Ÿæˆçš„ä»£æ›¿åŸå‡½æ•°çš„æŒ‡é’ˆï¼Œç”¨äºåœ¨hookå‡½æ•°ä¸­è°ƒç”¨åŸæ¥çš„é€»è¾‘
 - æ›¿æ¢symbolçš„å‰å‡ ä¸ªæŒ‡ä»¤ï¼Œå°†å…¶è·³è½¬åˆ°replaceçš„é¦–åœ°å€ï¼Œreplaceä¸­è°ƒç”¨*result(mmapæ–°çš„bufferï¼Œä¿å­˜old functionå¤´éƒ¨è¢«æ›¿æ¢çš„å­—èŠ‚ï¼Œå°¾éƒ¨è·³è½¬åˆ°åŸå‡½æ•°æœªè¢«æ›¿æ¢å­—èŠ‚çš„é¦–åœ°å€)
** PLT/GOT hook
*** PLT(procedure linkage table) GOT(global offset table)
*** example:
callq <printf@PLT> æŸ¥æ‰¾GOTä¸­ç›¸åº”è®°å½•ï¼Œè‹¥æ²¡æœ‰åŠ è½½printfåœ°å€ï¼ŒåŠ è½½soåº“ï¼Œä¿®æ”¹GOTä¸­printfè®°å½•åœ°å€ä¸ºçœŸå®åœ°å€ï¼Œåç»­è°ƒç”¨ç›´æ¥è°ƒç”¨GOTä¸­çœŸå®åœ°å€
*** dl_iterate_phdr
walk through list of shared objects
*** facebook profilo iqiyi xHook
* vcpkg
*** visual stduioç®¡ç†ç¬¬ä¸‰æ–¹libs
* unit test
*** å®‰å…¨çš„é‡æ„ä»£ç 
*** cmake && google test
*** gtest
**** assertions
| assertions | fatal | intercept |
|------------+-------+-----------|
| ASSERT_*   | YES   | YES       |
| EXPECT_*   | NO    | NO        |
**** fixtures
***** Using the Same Data Configuration for Multiple Tests
#+begin_src cpp
  // class Queue wanted to be tested
  template <typename E>  // E is the element type.
  class Queue {
   public:
    Queue();
    void Enqueue(const E& element);
    E* Dequeue();  // Returns NULL if the queue is empty.
    size_t size() const;
    ...
  };

  // test case fixture class
  class QueueTest : public ::testing::Test {
   protected:
    void SetUp() override {
       q1_.Enqueue(1);
       q2_.Enqueue(2);
       q2_.Enqueue(3);
    }

    // void TearDown() override {}

    Queue<int> q0_;
    Queue<int> q1_;
    Queue<int> q2_;
  };

  // tests
  TEST_F(QueueTest, IsEmptyInitially) {
    EXPECT_EQ(q0_.size(), 0);
  }

  TEST_F(QueueTest, DequeueWorks) {
    int* n = q0_.Dequeue();
    EXPECT_EQ(n, nullptr);

    n = q1_.Dequeue();
    ASSERT_NE(n, nullptr);
    EXPECT_EQ(*n, 1);
    EXPECT_EQ(q1_.size(), 0);
    delete n;

    n = q2_.Dequeue();
    ASSERT_NE(n, nullptr);
    EXPECT_EQ(*n, 2);
    EXPECT_EQ(q2_.size(), 1);
    delete n;
  }
#+end_src
**** running tests
***** TEST TEST_F éšå¼æ³¨å†Œåˆ°googletestï¼Œä¸éœ€è¦æ˜¾ç¤ºæŒ‡å®šéœ€è¦è¿è¡Œå“ªäº›æµ‹è¯•
***** RUN_ALL_TESTS()
* ASM
** event-based and tree-based api
** Parsing Generating Transforming class
** ClassReader ClassVisitor ClassWriter
** ClassWriter implemented ClassVisitor
*** visitXXXæ–¹æ³•è°ƒç”¨æ—¶ä¼šå†™å…¥å­—èŠ‚ç æ•°æ®
*** toByteArrayè¿”å›è®°å½•çš„å­—èŠ‚ç æ•°æ®
** ASMifier class -> java (generating class bytecode with ASM ClassWriter)
*** download asm-all-5.2.jar with all utils
*** java -classpath asm-all-5.2.jar org.objectweb.asm.util.ASMifier (${class file} | ${java.lang.Void})
* clojure
** cider
*** M-x cider-jack-in C-c M-j
* FPS tracer
** Choreographer.FrameCallback
* tracing activity startup
** reflect android.app.ActivityThread -> sCurrentActivityThread -> mH -> mCallback(hook with new one)
* ClassLoader
** locate or generate data that constitutes a definition for the class
** Class object contains a reference to the ClassLoader that defined it
** æ•°ç»„å¯¹è±¡çš„Classç”±JVMåˆ›å»ºï¼ŒéClassLoaderï¼Œä¸”ä¸å…¶å…ƒç´ ç±»å‹Classçš„ClassLoaderç›¸åŒï¼›åŸºæœ¬ç±»å‹æ•°æ®æ•°ç»„çš„Classæ— ClassLoader
** ä»£ç†åŠ è½½æœºåˆ¶ï¼Œå³å…ˆå‘çˆ¶ClassLoaderè¯·æ±‚åŠ è½½ç±»ï¼Œæœªæ‰¾åˆ°åˆ™è‡ªå·±åŠ è½½
** defineClass å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆClasså¯¹è±¡
* gradle
** gradle init --type java-application
** gradle jar
#+begin_src groovy
  jar {
      manifest {
          attributes("Main-Class": "App")
      }
  }

  task uberJar(type: Jar) {
      classifier = "all"
      from sourceSets.main.output
      manifest {
          attributes("Main-Class": "App")
      }

      dependsOn configurations.runtimeClasspath
      from {
          configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
      }

      with jar
  }
#+end_src
* PhontomReference
** ±ØĞëÓëÒıÓÃ¶ÓÁĞÒ»ÆğÊ¹ÓÃ£¬Ìá¹©ÔÚfinalizeÖ´ĞĞÖ®ºóµÃµ½Í¨ÖªµÄ»ú»á£¬±ÈÈçÖ´ĞĞpost-mortemÇåÀí»úÖÆ
* line-oriented search tools
** the silver searcher
** git grep
** ripgrep
* linux process group and session group
** process group
*** Ò»×é½ø³Ì£¬¾ßÓĞÏàÍ¬µÄ½ø³Ì×éid£¬ÓÃÓÚÏòÕâ¸ö½ø³Ì×é·¢ËÍĞÅºÅ£¬fork pipe´´½¨µÄ½ø³ÌÊôÓÚÒ»¸ö½ø³Ì×é
** session group
*** ¶à¸ö½ø³Ì×é×é³É»á»°
*** Ò»¸ö½ø³Ì×é²»ÄÜ´ÓÒ»¸ö»á»°Ç¨ÒÆµ½ÁíÍâÒ»¸ö»á»°
*** Ò»¸ö½ø³Ì×éÖ»ÄÜÊôÓÚÒ»¸ö»á»°
*** Ò»¸ö½ø³Ì²»ÄÜ´´½¨ÊôÓÚÆäËû»á»°µÄ½ø³Ì×é
* daemon process
** fork()
*** ×Ó½ø³Ì²»ÊÇÒ»¸ö½ø³Ì×éµÄ×é³¤½ø³Ì,ÕâÎªÏÂÃæÖ´ĞĞsetsid´´½¨ĞÂ»á»°´´½¨Ìõ¼ş
** setsid()
*** ³ÉÎªĞÂ»á»°µÄÊ×½ø³Ì
*** ³ÉÎªĞÂ½ø³Ì×éµÄ×é³¤½ø³Ì
*** Ã»ÓĞ¿ØÖÆÖÕ¶ËÓëÖ®ÏàÁ¬
** umask(0)
*** ·ÀÖ¹¼Ì³ĞµÃÀ´µÄÎÄ¼şÄ£Ê½´´½¨ÆÁ±Î×ÖÔÚ´´½¨ÎÄ¼şÊ±»á¾Ü¾øÉèÖÃÄ³Ğ©È¨ÏŞ
** close fds: STDIN_FILENO STDOUT_FILENO STDERR_FILENO
#+begin_src c
  int fd = open("/dev/null", O_RDWR);
  dup2(fd, STDIN_FILENO);
  dup2(fd, STDOUT_FILENO);
#+end_src

* UI
** smallestWidthÊÊÅä
*** [https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&mid=2650826034&idx=1&sn=5e86768d7abc1850b057941cdd003927&chksm=80b7b1acb7c038ba8912b9a09f7e0d41eef13ec0cea19462e47c4e4fe6a08ab760fec864c777&scene=21#wechat_redirect]
*** dp = px / density density = DPI/160
** ½ñÈÕÍ·Ìõ¼ÆËãdensity
* APK size
** proguard
*** Shrink¡¢Optimize ºÍ Obfuscate£¬Ò²¾ÍÊÇ²Ã¼ô¡¢ÓÅ»¯¡¢»ìÏı
** dex
*** facebook redex byte code optimizer
*** so file 7-zip XZ
** shrinkresources
*** Lint ÌáÊ¾ÎŞÓÃµÄ×ÊÔ´
*** shrinkResources true in gradle
**** Ã»ÓĞ´¦Àíresources.arscÎÄ¼ş
**** Ã»ÓĞÉ¾³ı×ÊÔ´ÎÄ¼ş
**** R.javaÎÄ¼şĞèÒªÌáÇ°×¼±¸ºÃ£¬ËùÓĞ×ÊÔ´¶¼·ÖÅäÁËÒ»¸ö³£Á¿ID£¬±àÒëJava´úÂë¹ı³Ì£¬½«´úÂëÖĞµÄ×ÊÔ´ÒıÓÃÌæ»»³É³£Á¿
* find duplicated number in array
** [http://keithschwarz.com/interesting/code/?dir=find-duplicate]
** ´ËÎÊÌâµÈ¼ÛÓÚÁ´±íÕÒ»·ÎÊÌâ
* linked list cycle
** ÅĞ¶ÏÊÇ·ñÓĞ»·
*** h tÁ½¸öÖ¸Õë´ÓÆğµãS³ö·¢£¬tÃ¿Ç°½ø1²½£¬hÇ°½ø2²½£¬Ö»Òª¶şÕß¶¼¿ÉÒÔÇ°½ø¶øÇÒÃ»ÓĞÏàÓö£¬¾Í±£³Ö¶şÕßÍÆ½ø¡£
*** µ±hÎŞ·¨Ç°½ø£¬¼´µ½´ïÄ³¸öÃ»ÓĞºó¼Ì½ÚµãÊ±£¬¿ÉÒÔÈ·¶¨´ÓS³ö·¢Ã»ÓĞ»·£¬·´Ö®µ±tºÍhÔÙ´ÎÏàÓöÊ±£¬¾Í¿ÉÒÔÈ·¶¨´ÓS³ö·¢Ò»¶¨»á½øÈëÄ³¸ö»·£¬ÉèÆäÎª»·C
** »·µÄ³¤¶È
*** ÅĞ¶Ï³ö´æÔÚ»·CÊ±£¬tºÍhÎ»ÓÚÍ¬Ò»µã£¬ÉèÆäÎª½ÚµãM¡£ÏÔÈ»£¬½öĞèÁîh²»¶¯£¬¶øt²»¶ÏÍÆ½ø£¬×îÖÕÓÖ»á»Øµ½½ÚµãM£¬Í³¼ÆÕâÒ»´ÎtÍÆ½øµÄ²½Êı£¬¼´µÃµ½»·µÄ³¤¶È
** »·µÄÆğµã
*** t´ÓÆğµãSµ½ÏàÓöµãM×ß¹ıµÄ¾àÀëÊÇ»·C³¤¶ÈµÄÕûÊı±¶£¬ÒòÎªh×ß¹ıµÄ¾àÀë±Èt×ß¹ıµÄ¾àÀë¶à»·³¤¶ÈµÄÕûÊı±¶£¬¶øhµÄËÙ¶ÈÊÇtµÄ2±¶
*** Áît»Øµ½ÆğµãS£¬Í¬Ê±ÈÃh´Ó½ÚµãM¹²Í¬ÍÆ½ø£¬hºÍt¶¼Ò»´ÎÇ°½øÒ»²½£¬µ±hºÍtÔÙ´ÎÏàÓöÊ±£¬Éè´Ë´ÎÏàÓöÊ±Î»ÓÚÍ¬Ò»½ÚµãP£¬ÔòP¼´Îª´ÓÆğµãS³ö·¢Ëùµ½´ï»·CµÄµÚÒ»¸ö½Úµã
=======
* git submodule
** git submodule add ${url}
** git clone -> git submodule init -> git submodule update
>>>>>>> e80601e80df28628831ae79051adec54334840ee
